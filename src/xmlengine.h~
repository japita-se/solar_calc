#ifndef _XMLENGINE_
#define _XMLENGINE_
#include "data.h"
#include <QDomDocument>
#include <QDomText>
#include <QPolygonF>
class QTreeWidget;
class QDomElemnt;
class QIODevice;
class QTreeWidgetItem;
class XmlEngine 

{
public:
	XmlEngine( );
	sy getSystem();
	void setSystem(QList<inverter> a, sy s);
	ecopara getEcoParameters();
	void setEcoParameters(ecopara o);
	void setPanelId(int i);
	void setInverterId(int i);
 	void setLoc(loc   l);
	void setOption(option o);
 	loc getLoc();
	option getOption();
	int getPanelId();
	int getInverterId();
// 	void save();
// 	void read();
	void updateInvertersTree();
	void updateLocTree();
	void updateComponentsTree();
	void updateOptionTree();
	void updateEcoTree();
	void setFile(QFile *f);
	void newTree();
	void write();
	void read();
	

private:
	void parseSiteEntry(const QDomElement &element);
	void parseInvEntry(const QDomElement &element);
	void parsePvEntry(const QDomElement &element);
	void parseOptEntry(const QDomElement &element);
	void parseEcoEntry(const QDomElement &element);
	loc localita;
	option   opt;
	ecopara  econ;
	QDomDocument doc;
	
	QDomElement root,panelElement,panelIdElement,inverterElement,inverterIdElement,  localitaElement;
	 QDomElement domLocName,domLocLatGradi,domLocLatMin,domLocLonGradi, domLocLonMin,domLocLonSec,optElement,ecoElement,
	domLocAnno, domLocAlbedo,domLocAlbedoModel,domLocIncl , domLocAddIncl,domLocRadCorr ,domLocTipo,domLocSource,domOptLoss[12],domLocLatSec,domLocArea,domLocAddArea,domLocWind,domLocMounting,domLocMountingH,domLocUtc,  domLocAzi,domAddAzi,domLocOmbre, domOptOmbrePath,domOptTempPath,domLocConc;
	QDomElement domTemperature[12],domWind[12],domEcoMinPrezziGARCH[4],domEcoPrezziGARCH[4];

	QDomElement domEcoRegime,domEcoFileBands,domEcoFileTariffe,domEcoFilePrezziEnergia,domEcoFilePrezziMinimi,domEcoPrezziEnergiaModel,
		    domEcoMinPrezziEnergiaModel,domEcoMaintenanceCost,domEcoTaxesCost,domEcoOtherCost,domEcoBenefitInitialCost,	
		    domEcoBenefitTotalInterest,	domEcoInitialCost,domEcoLoan,domEcoLoanYears,domEcoLoanInterestRate,
		    domEcoInflRate,domEcoInflEnergyRate,domEcoDiscountRate,domEcoLife,
		    domEcoMinPrezziEnergiaInflazione,domEcoPrezziEnergiaInflazione,domEcoTariffe[12],
		    domEcoPrezziEnergia[12],domEcoPrezziMinEnergia[12],domEcoBenefitVAT,domEcoMaintenanceSFreq,domEcoMaintenanceS,domThermalModel, domEcoBands[12], domEcoFileLoad,domEcoBonus,domEcoBonusW,domEcoAmm,domEcoAmmAnni,domEcoAssic,domEcoAssicAnni,
		    domFields,domStrings,domInvertersId,domOptNearOmbrePath,domOptScaling  ;

QFile  *d;
	int panelId,inverterId;
	QStringList bands;
	QPolygonF shadow;
	QList<inverter> inverters;
	sy systemDetails;
};
#endif